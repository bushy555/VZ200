; ASTRO and NYAN CAT de-compression RLE routine.
;
;
; To create compression routine:
;    Get PSP RAW image. (nyan1.raw)
;    STEPL NYAN1.RAW NYAN1.OUT     Option (A)    - Does nibbling into hex and outputs.
;    COMPRESS NYAN1.OUT NYAN1.RLE 		 - Does RLE compression and outputs.
;    STEPL NYAN1.RLE NYAN1.INC			 - Converts .RLE compressed BIN into an ASCII include file.
;    Get ascii include file, and add to this decmopression program.
;    Assemble and run.
;
;	
; Reads in from NYAN_PIC  (ASCII compressed RLE version of RAW screenshot)
; Decompresses and writes into BUFFER2
; BUFFER into $7000 video.
; Displays NYAN1.
;
;

video	equ	$7000
program equ	$8000
buffer1	equ	$B000
buffer2 equ	$C000

	org 	$8000

begin	di				; Don't need no interupts to interupt us.
	ld 	a,8
	ld 	($6800), a		; Mode(1)

loop1:	ld	hl, nyan_pic		; Put nyan into Buffer 1
	ld	de, buffer1		
	ld	bc, 2048
	ldir
	call	decompress		; decompress rountine

	ld	hl, astro_pic		; put astro into Buffer 1
	ld	de, buffer1
	ld	bc, 2048
	ldir
	call	decompress		; decompress rountine

	jp	loop1




; ==================================
; DECOMPRESS from buffer1 to Buffer2
; ==================================
decompress:
	ld	iy, 0		; Global screen position counter 0-2047
	ld	hl, buffer1	; 		; vid buffer 1 $B000
	ld	de, buffer2	;buffer2	; vid buffer 2 $C000 
	ld	a, (hl)
l0b:	ld	c, 0
l1b:	ld	a, (hl)
	ld	c, a		; C := original char for later.
l2b:	inc	hl		; inc HL pointer.
	inc	iy		; global counter
	ld	(de), a		; write out first CHAR
	inc	de
	ld	a, (hl)		; read CHAR QNTY
	inc	hl
	cp	1
	jr	z, here		; if equals 1, then jump out.
	ld	b, a		; load B qnty.
	dec	b		; decrease QNTY by one coz already have one
	ld	a, c		; CHAR into a 
writing:ld	(de), a		; write out number of CHARs
	inc	de
	inc	iy
	djnz	writing
here:	push	hl
	push	de
	push	iy
	push	iy
	pop	de
	ld	hl, 2048
	rst	$18
	jp	c, quit
	pop	iy
	pop	de
	pop	hl
	jr	l0b

quit:	pop	iy
	pop	de
	pop	hl

	ld	hl, buffer2	; display final uncompressed image
	ld	de, video	; from buffer2 to video screen.
	ld	bc, 2048
	ldir

	LD 	BC, $ff00	; delay in microseconds.
	call	0060H		; delay in ROM. 
	call	0060H		; delay in ROM. BC is kept.

	ret



	
nyan_pic:
db $0AA,$06E,$0BF,$001,$0FF,$005,$0FA,$001,$0AA,$019,$0D5,$001,$055,$005,$05E,$001
db $0AA,$018,$0AB,$001,$055,$006,$057,$001,$0AA,$00B,$0AB,$001,$0FF,$001,$0FA,$001
db $0AA,$001,$0BF,$001,$0FF,$001,$0AA,$001,$0AB,$001,$0FF,$001,$0FA,$001,$0AA,$001
db $0BF,$001,$0FF,$001,$0ED,$001,$055,$002,$057,$001,$055,$002,$05D,$001,$057,$001
db $0AA,$00B,$0FF,$00D,$0ED,$001,$055,$006,$057,$001,$0AA,$00B,$0FD,$001,$055,$001
db $05F,$001,$0FF,$001,$0D5,$001,$055,$001,$0FF,$001,$0FD,$001,$055,$001,$05F,$001
db $0FF,$001,$0D5,$001,$055,$001,$06D,$001,$057,$001,$055,$002,$057,$001,$05D,$001
db $055,$001,$057,$001,$0AA,$001,$0BA,$001,$0AA,$009,$055,$00D,$06D,$001,$055,$004
db $077,$001,$055,$001,$057,$001,$0AA,$001,$0DE,$001,$0AA,$009,$054,$001,$000,$001
db $005,$001,$055,$001,$040,$001,$000,$001,$055,$001,$054,$001,$000,$001,$005,$001
db $055,$001,$040,$001,$000,$001,$02D,$001,$055,$004,$075,$001,$0D5,$001,$057,$001
db $0AB,$001,$05E,$001,$0AA,$009,$000,$00D,$02D,$001,$055,$004,$075,$002,$057,$001
db $0AD,$001,$05E,$001,$0AA,$009,$002,$001,$0AA,$001,$0A0,$001,$000,$001,$02A,$001
db $0AA,$001,$000,$001,$002,$001,$0AA,$001,$0A0,$001,$000,$001,$02A,$001,$0AA,$001
db $0AD,$001,$055,$002,$05D,$001,$055,$001,$075,$001,$05D,$001,$057,$001,$0B5,$001
db $05E,$001,$0AA,$016,$0AD,$001,$057,$001,$055,$003,$075,$001,$057,$001,$0FF,$001
db $0D5,$001,$05E,$001,$0AA,$009,$0AB,$001,$0FF,$001,$0FA,$001,$0AA,$001,$0BF,$001
db $0FF,$001,$0AA,$001,$0AB,$001,$0FF,$001,$0FA,$001,$0AA,$001,$0BF,$001,$0FF,$001
db $0ED,$001,$055,$004,$075,$001,$055,$003,$05E,$001,$0AA,$009,$0FF,$00D,$0ED,$001
db $055,$004,$075,$001,$055,$003,$05E,$001,$0AA,$009,$0FD,$001,$055,$001,$05F,$001
db $0FF,$001,$0D5,$001,$055,$001,$0FF,$001,$0FD,$001,$055,$001,$05F,$001,$0FF,$001
db $0D7,$001,$0FF,$001,$0FD,$001,$055,$003,$057,$001,$0D5,$001,$049,$001,$055,$001
db $025,$001,$057,$001,$0EA,$001,$0AA,$008,$055,$00B,$05D,$001,$055,$001,$05D,$001
db $075,$001,$055,$001,$075,$001,$05D,$001,$055,$001,$069,$001,$055,$001,$0A5,$001
db $055,$001,$07A,$001,$0AA,$008,$054,$001,$000,$001,$005,$001,$055,$001,$040,$001
db $000,$001,$055,$001,$054,$001,$000,$001,$005,$001,$055,$001,$075,$001,$055,$001
db $05D,$001,$055,$003,$05D,$001,$055,$002,$07D,$001,$055,$002,$07A,$001,$0AA,$008
db $000,$00B,$035,$001,$07F,$001,$0FD,$001,$055,$003,$05D,$001,$045,$001,$055,$003
db $045,$001,$07A,$001,$0AA,$008,$002,$001,$0AA,$001,$0A0,$001,$000,$001,$02A,$001
db $0AA,$001,$000,$001,$002,$001,$0AA,$001,$0A0,$001,$000,$001,$0D5,$001,$0EA,$001
db $0AD,$001,$055,$003,$05D,$001,$055,$001,$075,$003,$055,$001,$07A,$001,$0AA,$013
db $0D7,$001,$0AA,$001,$0AD,$001,$055,$003,$057,$001,$055,$001,$07F,$001,$0FF,$001
db $0F5,$001,$055,$001,$0EA,$001,$0AA,$013,$0BE,$001,$0AA,$001,$0AD,$001,$055,$001
db $075,$001,$055,$002,$0D5,$001,$055,$003,$057,$001,$0AA,$016,$0AB,$001,$055,$004
db $075,$001,$055,$003,$05E,$001,$0AA,$017,$0D5,$001,$055,$003,$05F,$001,$0FF,$003
db $0FA,$001,$0AA,$016,$0B5,$001,$0FF,$004,$0FA,$001,$0B5,$001,$0AA,$001,$0D6,$001
db $0AA,$017,$0B5,$001,$0EB,$001,$05E,$001,$0AA,$003,$0B5,$001,$0AA,$001,$0D6,$001
db $0AA,$017,$0B7,$001,$0AB,$001,$07A,$001,$0AA,$003,$0D6,$001,$0AB,$001,$05A,$001
db $0AA,$017,$0BE,$001,$0AA,$001,$0FA,$001,$0AA,$0FE,$0AA,$0FE,$0AA,$0FE,$0AA,$0FE
db $0AA,$0FE
 ; ---------------------------------------------------------

astro_pic:
db $000,$016,$003,$001,$030,$001,$000,$01E,$002,$001,$0E0,$001,$000,$01F,$080,$001
db $000,$01E,$00B,$001,$038,$001,$000,$01E,$00E,$001,$00C,$001,$000,$01F,$0E2,$001
db $000,$01E,$038,$001,$00C,$001,$000,$01D,$00C,$001,$02E,$001,$0E2,$001,$040,$001
db $000,$01B,$032,$001,$0E2,$001,$060,$001,$00C,$001,$080,$001,$000,$01A,$003,$001
db $083,$001,$033,$001,$0B2,$001,$0E3,$001,$000,$005,$0C0,$001,$000,$015,$02E,$001
db $038,$001,$088,$001,$000,$001,$002,$001,$032,$001,$000,$003,$02E,$001,$038,$001
db $020,$001,$000,$00F,$0EE,$001,$0E0,$001,$000,$002,$002,$001,$0C0,$001,$003,$001
db $033,$001,$0BB,$001,$0B3,$001,$080,$001,$000,$003,$0C1,$001,$004,$001,$000,$00F
db $002,$001,$011,$001,$01B,$001,$000,$002,$003,$001,$08B,$001,$0B8,$001,$088,$001
db $000,$001,$008,$001,$038,$001,$000,$003,$004,$001,$003,$001,$020,$001,$000,$00E
db $02C,$001,$000,$001,$004,$001,$080,$001,$000,$001,$002,$001,$070,$001,$003,$001
db $033,$001,$0BB,$001,$0B3,$001,$08C,$001,$000,$002,$026,$001,$043,$001,$010,$001
db $000,$00F,$030,$001,$04C,$001,$043,$001,$030,$001,$002,$001,$038,$001,$08B,$001
db $0B8,$001,$088,$001,$0CC,$001,$008,$001,$020,$001,$000,$002,$0C0,$001,$030,$001
db $00C,$001,$000,$00F,$021,$001,$000,$001,$0C0,$001,$060,$001,$000,$001,$08C,$001
db $030,$001,$003,$001,$034,$001,$003,$001,$0B3,$001,$039,$001,$000,$001,$002,$001
db $04C,$001,$066,$001,$040,$001,$0E0,$001,$000,$00E,$0C0,$001,$0C4,$001,$030,$001
db $00C,$001,$003,$001,$020,$001,$022,$001,$0E2,$001,$0C9,$001,$0B0,$001,$022,$001
db $002,$001,$000,$001,$00C,$001,$020,$001,$00C,$001,$030,$001,$010,$001,$000,$00E
db $090,$001,$003,$001,$006,$001,$04B,$001,$0B8,$001,$0CE,$001,$0CC,$001,$03C,$001
db $010,$001,$00C,$001,$0CC,$001,$0EC,$001,$000,$001,$008,$001,$0C4,$001,$041,$001
db $001,$001,$008,$001,$000,$00D,$003,$001,$00C,$001,$04C,$001,$001,$001,$090,$001
db $000,$001,$088,$001,$022,$001,$0C0,$001,$00C,$001,$040,$001,$022,$001,$002,$001
db $000,$001,$00C,$001,$010,$001,$0C8,$001,$030,$001,$0C0,$001,$000,$00D,$008,$001
db $000,$002,$04C,$001,$03B,$001,$0BB,$001,$033,$002,$003,$002,$00E,$001,$073,$001
db $038,$001,$080,$001,$009,$001,$024,$001,$00D,$001,$00C,$001,$000,$00E,$00E,$001
db $04C,$001,$0C6,$001,$000,$001,$064,$001,$000,$001,$088,$001,$089,$001,$030,$001
db $064,$001,$000,$001,$002,$001,$027,$001,$000,$001,$00C,$001,$013,$001,$032,$001
db $040,$001,$048,$001,$000,$00D,$02C,$001,$000,$001,$001,$001,$0CC,$001,$030,$001
db $0EC,$001,$0CC,$001,$0E4,$001,$000,$001,$0C8,$001,$031,$001,$03C,$001,$0C0,$002
db $000,$001,$0C2,$001,$044,$001,$030,$001,$090,$001,$000,$00D,$0C3,$001,$011,$001
db $030,$001,$000,$001,$0C8,$001,$002,$001,$022,$001,$030,$001,$0C4,$001,$0B0,$001
db $000,$001,$00B,$001,$01C,$001,$080,$001,$08C,$001,$004,$001,$020,$001,$004,$001
db $000,$00E,$08C,$001,$00C,$001,$004,$001,$0CE,$001,$04E,$001,$0EC,$001,$0CC,$001
db $0C1,$001,$003,$001,$02E,$001,$033,$001,$010,$001,$021,$001,$090,$001,$060,$001
db $0C3,$001,$011,$001,$030,$001,$048,$001,$000,$00C,$003,$001,$010,$001,$040,$001
db $0C8,$001,$001,$001,$024,$001,$022,$002,$0C0,$001,$032,$001,$0C0,$001,$000,$001
db $004,$001,$043,$001,$00B,$001,$083,$001,$000,$001,$0E4,$001,$003,$001,$000,$00D
db $002,$001,$048,$001,$030,$001,$011,$001,$01B,$001,$000,$001,$03C,$001,$0F3,$001
db $00C,$001,$000,$001,$0B9,$001,$024,$001,$0C3,$001,$030,$001,$0E4,$001,$040,$001
db $011,$001,$00C,$001,$0CC,$001,$018,$001,$000,$00C,$00B,$001,$004,$001,$001,$001
db $00C,$001,$0B0,$001,$000,$001,$021,$001,$089,$001,$001,$001,$03B,$001,$00C,$001
db $0C0,$001,$000,$001,$080,$001,$0C0,$001,$013,$001,$00C,$001,$090,$001,$000,$001
db $060,$001,$000,$00C,$086,$001,$043,$001,$012,$001,$001,$001,$0E4,$001,$000,$001
db $003,$001,$004,$001,$090,$001,$000,$001,$0B2,$001,$004,$001,$0CC,$001,$00C,$001
db $083,$001,$000,$001,$043,$002,$013,$001,$000,$00D,$009,$001,$000,$001,$001,$001
db $0D8,$001,$00B,$001,$080,$001,$030,$001,$0C3,$001,$003,$001,$03B,$001,$021,$001
db $010,$001,$003,$001,$080,$001,$0C4,$001,$030,$002,$0CC,$001,$000,$00E,$004,$001
db $030,$001,$0CC,$001,$093,$001,$004,$001,$064,$001,$009,$001,$000,$001,$030,$001
db $002,$001,$0C0,$001,$00C,$001,$048,$001,$0C3,$001,$000,$001,$004,$001,$0C3,$001
db $000,$001,$032,$001,$000,$00D,$00B,$001,$004,$001,$000,$001,$00C,$001,$010,$001
db $01B,$001,$082,$001,$0C4,$001,$001,$001,$031,$001,$00C,$001,$0C0,$001,$032,$001
db $009,$001,$00C,$001,$040,$001,$034,$001,$0C0,$001,$000,$00F,$003,$001,$004,$001
db $040,$001,$043,$001,$000,$001,$04C,$001,$093,$001,$010,$001,$000,$001,$0C0,$001
db $013,$001,$02C,$001,$0CC,$001,$010,$001,$033,$001,$00C,$001,$013,$001,$038,$001
db $000,$00E,$0E4,$001,$010,$001,$030,$002,$010,$001,$000,$001,$0E0,$001,$00C,$001
db $0C4,$001,$004,$001,$000,$001,$03B,$001,$024,$001,$0C3,$001,$00C,$001,$040,$001
db $026,$001,$000,$010,$0C3,$001,$003,$001,$001,$001,$00C,$001,$04C,$001,$043,$001
db $000,$001,$003,$001,$093,$001,$030,$001,$0C2,$001,$060,$001,$000,$001,$010,$001
db $031,$001,$098,$001,$000,$00F,$00B,$001,$000,$001,$030,$001,$010,$001,$0C0,$001
db $010,$001,$038,$001,$04C,$001,$04F,$001,$070,$001,$003,$001,$0B9,$001,$091,$001
db $031,$001,$00C,$001,$00B,$001,$000,$011,$0B1,$001,$001,$001,$00C,$002,$0D4,$001
db $0C1,$001,$000,$001,$03F,$001,$0F9,$001,$030,$001,$046,$001,$040,$001,$000,$001
db $0C0,$002,$000,$011,$002,$001,$04C,$001,$000,$001,$0C0,$001,$00C,$001,$004,$001
db $0C4,$001,$0C3,$001,$0B6,$001,$043,$001,$003,$001,$00C,$001,$04C,$001,$00C,$001
db $000,$012,$003,$001,$080,$001,$0CC,$001,$004,$001,$040,$002,$048,$001,$00C,$001
db $0C0,$001,$004,$001,$030,$001,$001,$001,$000,$001,$0C8,$001,$000,$013,$038,$001
db $090,$001,$041,$001,$084,$001,$033,$001,$013,$001,$00C,$001,$04C,$001,$048,$001
db $003,$001,$030,$001,$0CC,$001,$080,$001,$000,$012,$0EC,$001,$08E,$001,$04C,$001
db $010,$001,$043,$001,$014,$001,$00C,$001,$002,$001,$000,$001,$0C1,$001,$019,$001
db $000,$001,$020,$001,$040,$001,$000,$011,$00E,$001,$022,$001,$023,$001,$000,$001
db $033,$001,$00D,$001,$00C,$001,$040,$001,$0ED,$001,$0C4,$001,$004,$001,$0E4,$001
db $0C6,$001,$0D0,$001,$000,$011,$03B,$001,$0B2,$001,$0CE,$001,$0C8,$001,$031,$001
db $090,$001,$000,$001,$0C1,$001,$030,$001,$010,$001,$02E,$001,$0CB,$001,$010,$001
db $02C,$001,$000,$010,$03B,$001,$0FB,$001,$080,$001,$040,$001,$0B8,$001,$093,$001
db $004,$001,$003,$001,$034,$001,$013,$001,$001,$001,$003,$001,$001,$001,$004,$001
db $00E,$001,$000,$011,$0BF,$001,$0F0,$001,$044,$001,$00C,$001,$0C3,$001,$020,$001
db $00C,$001,$04C,$001,$004,$002,$010,$001,$0C4,$001,$010,$001,$043,$001,$080,$001
db $000,$010,$0EF,$001,$0FF,$001,$030,$001,$0C3,$001,$038,$001,$088,$001,$00E,$001
db $040,$001,$000,$001,$043,$001,$031,$001,$00C,$001,$020,$001,$0C3,$001,$02C,$001
db $000,$010,$0EF,$001,$0FE,$001,$0FF,$001,$081,$001,$000,$001,$00C,$001,$0CC,$001
db $088,$001,$0C3,$001,$030,$002,$040,$001,$0C0,$001,$070,$001,$018,$001,$0C0,$001
db $000,$00F,$03B,$001,$0FF,$002,$0FC,$001,$010,$001,$0C4,$001,$0E2,$001,$023,$001
db $032,$001,$000,$001,$004,$001,$0C1,$001,$030,$001,$00C,$001,$09B,$001,$020,$001
db $000,$010,$0BF,$001,$0FF,$001,$0FB,$001,$0FF,$001,$00C,$001,$000,$001,$033,$001
db $032,$001,$022,$001,$0E4,$001,$0C0,$001,$004,$002,$0C0,$001,$0E4,$001,$000,$010
db $003,$001,$0FF,$003,$0FE,$001,$000,$001,$033,$001,$022,$001,$023,$001,$038,$001
db $039,$001,$00C,$001,$04C,$001,$0C0,$001,$018,$001,$000,$010,$032,$001,$0CB,$001
db $0FF,$001,$0FE,$001,$0FF,$001,$0FD,$001,$031,$001,$000,$001,$04C,$001,$0C2,$001
db $022,$001,$020,$001,$010,$001,$000,$001,$013,$001,$024,$001,$000,$00F,$003,$001
db $035,$001,$05F,$001,$0FF,$004,$000,$001,$0C4,$001,$0B8,$001,$08C,$001,$0CC,$001
db $08E,$001,$0C3,$001,$031,$001,$008,$001,$0C0,$001,$000,$00F,$0CD,$001,$015,$001
db $05F,$001,$0FF,$001,$0EF,$001,$0FE,$001,$0FF,$001,$013,$001,$000,$001,$063,$001
db $008,$001,$08B,$001,$020,$001,$024,$001,$000,$001,$024,$001,$000,$00F,$0C2,$001
db $055,$001,$05C,$001,$0CF,$001,$0FE,$001,$0FF,$003,$0B0,$001,$013,$001,$032,$001
db $033,$001,$032,$001,$0C2,$001,$0C8,$001,$0CE,$001,$040,$001,$000,$00F,$00D,$001
db $053,$001,$005,$001,$07B,$001,$0FF,$003,$07F,$001,$0D9,$001,$000,$001,$083,$001
db $022,$001,$020,$001,$0B8,$001,$08E,$001,$020,$001,$000,$00F,$00C,$001,$0D5,$001
db $053,$001,$077,$001,$05F,$001,$0FF,$002,$0F3,$001,$0BF,$001,$0FF,$001,$0B9,$001
db $0CB,$001,$033,$002,$00C,$001,$0E0,$001,$000,$010,$003,$001,$055,$001,$05D,$001
db $075,$001,$0C7,$001,$0FF,$005,$0C0,$001,$010,$001,$0B8,$001,$088,$001,$08B,$001
db $000,$011,$001,$001,$055,$001,$051,$001,$065,$001,$016,$001,$0FF,$001,$0FC,$001
db $0FF,$001,$0CB,$001,$0B3,$001,$0FC,$001,$00C,$001,$04D,$001,$0EE,$001,$040,$001
db $000,$011,$024,$001,$011,$001,$055,$002,$05D,$001,$03B,$001,$0EF,$002,$0FF,$002
db $0F9,$001,$010,$001,$008,$001,$000,$014,$00C,$002,$0D5,$001,$0CD,$001,$0D7,$001
db $03F,$001,$0FF,$002,$0CF,$001,$0FF,$001,$0CE,$001,$044,$001,$000,$015,$002,$001
db $055,$001,$064,$001,$071,$001,$0FF,$005,$0F0,$001,$000,$016,$0B5,$001,$055,$001
db $05D,$001,$0D3,$001,$02F,$001,$0FF,$002,$0FB,$001,$0BF,$001,$080,$001,$000,$016
db $0C0,$001,$015,$001,$054,$001,$051,$001,$05B,$001,$0FB,$001,$0EE,$001,$0C0,$001
db $040,$001,$000,$018,$009,$001,$095,$001,$037,$001,$000,$001,$0BC,$001,$0C1,$001
db $000,$019,$003,$001,$033,$001,$008,$001,$0C0,$001;,$000,$021
 ; ---------------------------------------------------------


end

